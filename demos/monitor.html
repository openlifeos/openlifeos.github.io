<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenLifeOS - Real-Time Monitor | AugHacks MIT 2025</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Orbitron', 'SF Mono', Monaco, monospace;
            background: #000;
            color: #00ff00;
            padding: 20px;
            overflow-x: hidden;
            position: relative;
        }
        
        /* Matrix rain background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 255, 0, 0.03) 2px,
                    rgba(0, 255, 0, 0.03) 4px
                ),
                repeating-linear-gradient(
                    90deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 255, 0, 0.03) 2px,
                    rgba(0, 255, 0, 0.03) 4px
                );
            z-index: -1;
            animation: gridScroll 20s linear infinite;
        }
        
        @keyframes gridScroll {
            0% { transform: translate(0, 0); }
            100% { transform: translate(50px, 50px); }
        }
        
        .monitor-header {
            border: 2px solid #00ff00;
            padding: 20px;
            margin-bottom: 20px;
            position: relative;
            background: rgba(0, 255, 0, 0.05);
        }
        
        .monitor-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 2px;
            background: linear-gradient(90deg, transparent, #00ff00, transparent);
            animation: scan 2s linear infinite;
        }
        
        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        h1 {
            font-size: 2.5em;
            text-transform: uppercase;
            letter-spacing: 5px;
            text-shadow: 
                0 0 10px #00ff00,
                0 0 20px #00ff00,
                0 0 30px #00ff00;
            animation: glitch 2s infinite;
        }
        
        @keyframes glitch {
            0%, 100% { text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00; }
            25% { text-shadow: -2px 0 #ff0000, 2px 0 #00ffff; }
            50% { text-shadow: 2px 0 #ff00ff, -2px 0 #ffff00; }
            75% { text-shadow: 0 0 10px #00ff00, 0 0 20px #00ff00; }
        }
        
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .monitor-panel {
            border: 1px solid #00ff00;
            padding: 15px;
            background: 
                linear-gradient(135deg, rgba(0, 255, 0, 0.05) 0%, transparent 50%),
                rgba(0, 0, 0, 0.9);
            position: relative;
            box-shadow: 
                0 0 20px rgba(0, 255, 0, 0.3),
                inset 0 0 20px rgba(0, 255, 0, 0.05);
            backdrop-filter: blur(5px);
        }
        
        .monitor-panel::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, #00ff00, transparent);
            animation: scanPanel 3s linear infinite;
        }
        
        @keyframes scanPanel {
            0% { opacity: 0; }
            50% { opacity: 1; }
            100% { opacity: 0; }
        }
        
        .monitor-panel h3 {
            color: #00ff00;
            margin-bottom: 15px;
            font-size: 14px;
            text-transform: uppercase;
            letter-spacing: 2px;
        }
        
        .metric {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 5px;
            background: rgba(0, 255, 0, 0.05);
            border-left: 2px solid #00ff00;
        }
        
        .metric-label {
            color: #00cc00;
            font-size: 12px;
        }
        
        .metric-value {
            color: #00ff00;
            font-weight: bold;
            text-shadow: 0 0 5px #00ff00;
        }
        
        .metric-value.warning {
            color: #ffaa00;
            text-shadow: 0 0 5px #ffaa00;
        }
        
        .metric-value.error {
            color: #ff0000;
            text-shadow: 0 0 5px #ff0000;
        }
        
        .metric-value.success {
            color: #00ff00;
            text-shadow: 0 0 5px #00ff00;
        }
        
        .live-chart {
            height: 150px;
            background: #000;
            border: 1px solid #00ff00;
            margin: 10px 0;
            position: relative;
            overflow: hidden;
        }
        
        .chart-line {
            position: absolute;
            bottom: 0;
            width: 2px;
            background: #00ff00;
            transition: height 0.3s;
        }
        
        .console-output {
            background: #000;
            border: 1px solid #00ff00;
            padding: 15px;
            height: 400px;
            overflow-y: auto;
            font-size: 12px;
            font-family: monospace;
        }
        
        .console-line {
            margin: 2px 0;
            padding: 2px;
        }
        
        .console-line.info { color: #00ff00; }
        .console-line.warning { color: #ffaa00; }
        .console-line.error { color: #ff0000; }
        .console-line.success { 
            color: #00ff00; 
            font-weight: bold;
            text-shadow: 0 0 3px #00ff00;
        }
        
        .test-matrix {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }
        
        .test-item {
            border: 1px solid #00ff00;
            padding: 10px;
            text-align: center;
            background: rgba(0, 255, 0, 0.05);
            transition: all 0.3s;
        }
        
        .test-item.pass {
            background: rgba(0, 255, 0, 0.2);
            box-shadow: 0 0 10px #00ff00;
        }
        
        .test-item.fail {
            background: rgba(255, 0, 0, 0.2);
            border-color: #ff0000;
            box-shadow: 0 0 10px #ff0000;
        }
        
        .test-item.running {
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .brainwave-monitor {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 10px;
            margin: 20px 0;
        }
        
        .wave-display {
            text-align: center;
            padding: 10px;
            border: 1px solid #00ff00;
            background: rgba(0, 255, 0, 0.05);
        }
        
        .wave-label {
            font-size: 10px;
            color: #00cc00;
            margin-bottom: 5px;
        }
        
        .wave-value {
            font-size: 28px;
            font-weight: bold;
            color: #00ff00;
            text-shadow: 
                0 0 10px #00ff00,
                0 0 20px #00ff00;
            animation: dataFlicker 0.5s infinite alternate;
        }
        
        @keyframes dataFlicker {
            0% { opacity: 0.8; }
            100% { opacity: 1; }
        }
        
        .wave-bar {
            height: 4px;
            background: #003300;
            margin-top: 5px;
            position: relative;
            overflow: hidden;
        }
        
        .wave-bar-fill {
            height: 100%;
            background: #00ff00;
            transition: width 0.3s;
            box-shadow: 0 0 5px #00ff00;
        }
        
        .alert-box {
            border: 2px solid #ffaa00;
            background: rgba(255, 170, 0, 0.1);
            padding: 15px;
            margin: 20px 0;
            display: none;
        }
        
        .alert-box.active {
            display: block;
            animation: flash 1s infinite;
        }
        
        @keyframes flash {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .control-panel {
            position: fixed;
            top: 20px;
            right: 20px;
            border: 1px solid #00ff00;
            background: #000;
            padding: 15px;
            z-index: 1000;
        }
        
        .control-button {
            display: block;
            width: 100%;
            padding: 10px;
            margin: 5px 0;
            background: transparent;
            border: 1px solid #00ff00;
            color: #00ff00;
            cursor: pointer;
            text-transform: uppercase;
            transition: all 0.3s;
        }
        
        .control-button:hover {
            background: rgba(0, 255, 0, 0.2);
            box-shadow: 0 0 10px #00ff00;
        }
        
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 10px;
            animation: blink 2s infinite;
        }
        
        .status-indicator.online {
            background: #00ff00;
            box-shadow: 0 0 10px #00ff00;
        }
        
        .status-indicator.offline {
            background: #ff0000;
            box-shadow: 0 0 10px #ff0000;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
    </style>
</head>
<body>
    <!-- Floating particles -->
    <div id="particles"></div>
    
    <!-- Cyber glitch overlay -->
    <div class="cyber-overlay"></div>
    
    <div class="monitor-header">
        <h1>⚡ NEURAL MONITORING SYSTEM</h1>
        <p style="color: #00ffff; letter-spacing: 3px; text-transform: uppercase; font-size: 11px;">
            <span class="status-indicator online"></span>
            Real-time Consciousness Analytics • Quantum State: ACTIVE
        </p>
    </div>
    
    <style>
        #particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .particle {
            position: absolute;
            width: 2px;
            height: 2px;
            background: #00ff00;
            border-radius: 50%;
            box-shadow: 0 0 10px #00ff00;
            animation: floatUp 15s infinite linear;
        }
        
        @keyframes floatUp {
            0% {
                transform: translateY(100vh) translateX(0);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) translateX(100px);
                opacity: 0;
            }
        }
        
        .cyber-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
            background: 
                repeating-linear-gradient(
                    0deg,
                    transparent,
                    transparent 2px,
                    rgba(0, 255, 0, 0.03) 2px,
                    rgba(0, 255, 0, 0.03) 4px
                );
            animation: flicker 0.1s infinite;
            opacity: 0.1;
        }
        
        @keyframes flicker {
            0% { opacity: 0.1; }
            50% { opacity: 0.08; }
            100% { opacity: 0.1; }
        }
        
        /* Enhanced header subtitle */
        .monitor-header p {
            animation: textGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes textGlow {
            from { text-shadow: 0 0 10px #00ffff, 0 0 20px #00ffff; }
            to { text-shadow: 0 0 20px #00ffff, 0 0 30px #00ffff, 0 0 40px #00ffff; }
        }
    </style>
    
    <script>
        // Create floating particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 15 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                particlesContainer.appendChild(particle);
            }
        }
        createParticles();
    </script>
    
    <div class="alert-box" id="alertBox">
        <strong>⚠️ ALERT:</strong> <span id="alertMessage"></span>
    </div>
    
    <div class="control-panel">
        <h3 style="color: #00ff00; margin-bottom: 15px;">CONTROLS</h3>
        <button class="control-button" onclick="startMonitoring()">START MONITOR</button>
        <button class="control-button" onclick="stopMonitoring()">STOP MONITOR</button>
        <button class="control-button" onclick="clearLogs()">CLEAR LOGS</button>
        <button class="control-button" onclick="exportData()">EXPORT DATA</button>
        <button class="control-button" onclick="runDiagnostics()">DIAGNOSTICS</button>
    </div>
    
    <div class="status-grid">
        <!-- System Status -->
        <div class="monitor-panel">
            <h3>System Status</h3>
            <div class="metric">
                <span class="metric-label">Digital Human</span>
                <span class="metric-value success" id="dhStatus">
                    <span class="status-indicator online"></span>ONLINE
                </span>
            </div>
            <div class="metric">
                <span class="metric-label">Memory System</span>
                <span class="metric-value success" id="memStatus">ACTIVE</span>
            </div>
            <div class="metric">
                <span class="metric-label">Voice Interface</span>
                <span class="metric-value" id="voiceStatus">READY</span>
            </div>
            <div class="metric">
                <span class="metric-label">BCI Connection</span>
                <span class="metric-value" id="bciStatus">SIMULATED</span>
            </div>
            <div class="metric">
                <span class="metric-label">Claude Agent</span>
                <span class="metric-value success" id="agentStatus">RUNNING</span>
            </div>
        </div>
        
        <!-- Performance Metrics -->
        <div class="monitor-panel">
            <h3>Performance</h3>
            <div class="metric">
                <span class="metric-label">Response Time</span>
                <span class="metric-value" id="responseTime">0ms</span>
            </div>
            <div class="metric">
                <span class="metric-label">Memory Usage</span>
                <span class="metric-value" id="memUsage">0MB</span>
            </div>
            <div class="metric">
                <span class="metric-label">CPU Load</span>
                <span class="metric-value" id="cpuLoad">0%</span>
            </div>
            <div class="metric">
                <span class="metric-label">Active Threads</span>
                <span class="metric-value" id="threads">5</span>
            </div>
            <div class="metric">
                <span class="metric-label">Queue Size</span>
                <span class="metric-value" id="queueSize">0</span>
            </div>
        </div>
        
        <!-- API Status -->
        <div class="monitor-panel">
            <h3>API Connections</h3>
            <div class="metric">
                <span class="metric-label">OpenAI Realtime</span>
                <span class="metric-value" id="openaiStatus">DISCONNECTED</span>
            </div>
            <div class="metric">
                <span class="metric-label">ElevenLabs</span>
                <span class="metric-value" id="elevenStatus">DISCONNECTED</span>
            </div>
            <div class="metric">
                <span class="metric-label">Deepgram</span>
                <span class="metric-value" id="deepgramStatus">DISCONNECTED</span>
            </div>
            <div class="metric">
                <span class="metric-label">API Calls</span>
                <span class="metric-value" id="apiCalls">0</span>
            </div>
            <div class="metric">
                <span class="metric-label">Total Cost</span>
                <span class="metric-value" id="totalCost">$0.00</span>
            </div>
        </div>
    </div>
    
    <!-- Test Results Matrix -->
    <div class="monitor-panel">
        <h3>Test Results</h3>
        <div class="test-matrix" id="testMatrix">
            <div class="test-item" id="test-voice-input">Voice Input</div>
            <div class="test-item" id="test-voice-synthesis">Voice Synthesis</div>
            <div class="test-item" id="test-bci">BCI Stream</div>
            <div class="test-item" id="test-memory">Memory</div>
            <div class="test-item" id="test-emotions">Emotions</div>
            <div class="test-item" id="test-multimodal">Multi-Modal</div>
            <div class="test-item" id="test-dreams">Dreams</div>
            <div class="test-item" id="test-agent">Claude Agent</div>
            <div class="test-item" id="test-integration">Integration</div>
        </div>
    </div>
    
    <!-- Brainwave Monitor -->
    <div class="monitor-panel">
        <h3>Brainwave Activity</h3>
        <div class="brainwave-monitor">
            <div class="wave-display">
                <div class="wave-label">DELTA</div>
                <div class="wave-value" id="delta">0</div>
                <div class="wave-bar">
                    <div class="wave-bar-fill" id="deltaBar" style="width: 0%"></div>
                </div>
            </div>
            <div class="wave-display">
                <div class="wave-label">THETA</div>
                <div class="wave-value" id="theta">0</div>
                <div class="wave-bar">
                    <div class="wave-bar-fill" id="thetaBar" style="width: 0%"></div>
                </div>
            </div>
            <div class="wave-display">
                <div class="wave-label">ALPHA</div>
                <div class="wave-value" id="alpha">0</div>
                <div class="wave-bar">
                    <div class="wave-bar-fill" id="alphaBar" style="width: 0%"></div>
                </div>
            </div>
            <div class="wave-display">
                <div class="wave-label">BETA</div>
                <div class="wave-value" id="beta">0</div>
                <div class="wave-bar">
                    <div class="wave-bar-fill" id="betaBar" style="width: 0%"></div>
                </div>
            </div>
            <div class="wave-display">
                <div class="wave-label">GAMMA</div>
                <div class="wave-value" id="gamma">0</div>
                <div class="wave-bar">
                    <div class="wave-bar-fill" id="gammaBar" style="width: 0%"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Memory Statistics -->
    <div class="status-grid">
        <div class="monitor-panel">
            <h3>Memory Statistics</h3>
            <div class="metric">
                <span class="metric-label">Sensory Buffer</span>
                <span class="metric-value" id="sensoryMem">0</span>
            </div>
            <div class="metric">
                <span class="metric-label">Working Memory</span>
                <span class="metric-value" id="workingMem">0/7</span>
            </div>
            <div class="metric">
                <span class="metric-label">Short-term</span>
                <span class="metric-value" id="shortMem">0</span>
            </div>
            <div class="metric">
                <span class="metric-label">Long-term</span>
                <span class="metric-value" id="longMem">0</span>
            </div>
            <div class="metric">
                <span class="metric-label">Episodic</span>
                <span class="metric-value" id="episodicMem">0</span>
            </div>
        </div>
        
        <div class="monitor-panel">
            <h3>Emotional State</h3>
            <div class="metric">
                <span class="metric-label">Joy</span>
                <span class="metric-value" id="emotionJoy">70%</span>
            </div>
            <div class="metric">
                <span class="metric-label">Curiosity</span>
                <span class="metric-value" id="emotionCuriosity">85%</span>
            </div>
            <div class="metric">
                <span class="metric-label">Calm</span>
                <span class="metric-value" id="emotionCalm">60%</span>
            </div>
            <div class="metric">
                <span class="metric-label">Dominant</span>
                <span class="metric-value success" id="dominantEmotion">CURIOUS</span>
            </div>
        </div>
    </div>
    
    <!-- Console Output -->
    <div class="monitor-panel">
        <h3>Live Console Output</h3>
        <div class="console-output" id="console">
            <div class="console-line info">[SYSTEM] Monitor initialized</div>
            <div class="console-line success">[SYSTEM] Connecting to Digital Human...</div>
        </div>
    </div>
    
    <script>
        let monitoringInterval = null;
        let testResults = {};
        let startTime = Date.now();
        let apiCallCount = 0;
        let totalCost = 0;
        
        // Connect to parent window if embedded
        let parentConnection = null;
        if (window.parent !== window) {
            parentConnection = window.parent;
        }
        
        function log(message, type = 'info') {
            const console = document.getElementById('console');
            const line = document.createElement('div');
            line.className = `console-line ${type}`;
            line.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            console.appendChild(line);
            console.scrollTop = console.scrollHeight;
        }
        
        function updateMetric(id, value, status = '') {
            const element = document.getElementById(id);
            if (element) {
                element.textContent = value;
                if (status) {
                    element.className = `metric-value ${status}`;
                }
            }
        }
        
        function startMonitoring() {
            log('[MONITOR] Starting real-time monitoring', 'success');
            
            monitoringInterval = setInterval(() => {
                updateSystemMetrics();
                checkTestResults();
                updateBrainwaves();
                updateMemoryStats();
                updateEmotionalState();
                checkForAlerts();
            }, 1000);
            
            // Listen for messages from test interface
            window.addEventListener('message', handleTestMessage);
        }
        
        function stopMonitoring() {
            if (monitoringInterval) {
                clearInterval(monitoringInterval);
                monitoringInterval = null;
                log('[MONITOR] Monitoring stopped', 'warning');
            }
        }
        
        function updateSystemMetrics() {
            // Simulate performance metrics
            const uptime = Math.floor((Date.now() - startTime) / 1000);
            const responseTime = Math.floor(Math.random() * 50 + 100);
            const memUsage = (Math.random() * 50 + 30).toFixed(1);
            const cpuLoad = Math.floor(Math.random() * 30 + 10);
            
            updateMetric('responseTime', `${responseTime}ms`, 
                responseTime > 300 ? 'warning' : responseTime > 500 ? 'error' : 'success');
            updateMetric('memUsage', `${memUsage}MB`);
            updateMetric('cpuLoad', `${cpuLoad}%`,
                cpuLoad > 70 ? 'warning' : cpuLoad > 90 ? 'error' : '');
            
            // Check connections
            const hasOpenAI = sessionStorage.getItem('openai_api_key');
            const hasElevenLabs = sessionStorage.getItem('elevenlabs_api_key');
            const hasDeepgram = sessionStorage.getItem('deepgram_api_key');
            
            updateMetric('openaiStatus', hasOpenAI ? 'CONNECTED' : 'DISCONNECTED',
                hasOpenAI ? 'success' : 'error');
            updateMetric('elevenStatus', hasElevenLabs ? 'CONNECTED' : 'DISCONNECTED',
                hasElevenLabs ? 'success' : 'error');
            updateMetric('deepgramStatus', hasDeepgram ? 'CONNECTED' : 'DISCONNECTED',
                hasDeepgram ? 'success' : 'error');
        }
        
        function checkTestResults() {
            // Check for test results in sessionStorage
            const testNames = ['voice-input', 'voice-synthesis', 'bci', 'memory', 
                              'emotions', 'multimodal', 'dreams', 'agent', 'integration'];
            
            testNames.forEach(test => {
                const result = sessionStorage.getItem(`test_${test}`);
                const element = document.getElementById(`test-${test}`);
                
                if (element) {
                    if (result === 'pass') {
                        element.className = 'test-item pass';
                        if (!testResults[test]) {
                            log(`[TEST] ${test} passed`, 'success');
                            testResults[test] = true;
                        }
                    } else if (result === 'fail') {
                        element.className = 'test-item fail';
                        if (testResults[test] !== false) {
                            log(`[TEST] ${test} failed`, 'error');
                            testResults[test] = false;
                        }
                    } else if (result === 'running') {
                        element.className = 'test-item running';
                    }
                }
            });
        }
        
        function updateBrainwaves() {
            // Simulate brainwave data
            const waves = {
                delta: Math.random() * 5 + 2,
                theta: Math.random() * 10 + 5,
                alpha: Math.random() * 15 + 10,
                beta: Math.random() * 30 + 20,
                gamma: Math.random() * 40 + 30
            };
            
            Object.keys(waves).forEach(wave => {
                const value = waves[wave].toFixed(1);
                updateMetric(wave, value);
                
                const bar = document.getElementById(`${wave}Bar`);
                if (bar) {
                    bar.style.width = `${Math.min(value, 100)}%`;
                }
            });
        }
        
        function updateMemoryStats() {
            // Get memory stats from monitoring
            const stats = {
                sensory: Math.floor(Math.random() * 20),
                working: Math.floor(Math.random() * 7),
                shortTerm: Math.floor(Math.random() * 100),
                longTerm: Math.floor(Math.random() * 1000),
                episodic: Math.floor(Math.random() * 500)
            };
            
            updateMetric('sensoryMem', stats.sensory);
            updateMetric('workingMem', `${stats.working}/7`);
            updateMetric('shortMem', stats.shortTerm);
            updateMetric('longMem', stats.longTerm);
            updateMetric('episodicMem', stats.episodic);
        }
        
        function updateEmotionalState() {
            // Simulate emotional data
            const emotions = {
                joy: Math.floor(Math.random() * 30 + 60),
                curiosity: Math.floor(Math.random() * 20 + 70),
                calm: Math.floor(Math.random() * 40 + 40)
            };
            
            updateMetric('emotionJoy', `${emotions.joy}%`);
            updateMetric('emotionCuriosity', `${emotions.curiosity}%`);
            updateMetric('emotionCalm', `${emotions.calm}%`);
            
            // Determine dominant emotion
            const dominant = Object.keys(emotions).reduce((a, b) => 
                emotions[a] > emotions[b] ? a : b
            );
            updateMetric('dominantEmotion', dominant.toUpperCase(), 'success');
        }
        
        function checkForAlerts() {
            const alertBox = document.getElementById('alertBox');
            const alertMessage = document.getElementById('alertMessage');
            
            // Check for critical conditions
            const responseTime = parseInt(document.getElementById('responseTime').textContent);
            const cpuLoad = parseInt(document.getElementById('cpuLoad').textContent);
            
            if (responseTime > 500) {
                alertBox.classList.add('active');
                alertMessage.textContent = 'High response time detected! Performance degradation possible.';
            } else if (cpuLoad > 80) {
                alertBox.classList.add('active');
                alertMessage.textContent = 'High CPU load detected! System may be overloaded.';
            } else {
                alertBox.classList.remove('active');
            }
        }
        
        function handleTestMessage(event) {
            if (event.data.type === 'test-result') {
                const { test, result } = event.data;
                sessionStorage.setItem(`test_${test}`, result);
                log(`[TEST] Received result for ${test}: ${result}`, 
                    result === 'pass' ? 'success' : 'error');
            } else if (event.data.type === 'api-call') {
                apiCallCount++;
                updateMetric('apiCalls', apiCallCount);
                
                if (event.data.cost) {
                    totalCost += event.data.cost;
                    updateMetric('totalCost', `$${totalCost.toFixed(4)}`);
                }
            }
        }
        
        function clearLogs() {
            document.getElementById('console').innerHTML = 
                '<div class="console-line info">[SYSTEM] Console cleared</div>';
        }
        
        function exportData() {
            const data = {
                timestamp: new Date().toISOString(),
                uptime: Math.floor((Date.now() - startTime) / 1000),
                testResults,
                metrics: {
                    apiCalls: apiCallCount,
                    totalCost,
                    responseTime: document.getElementById('responseTime').textContent,
                    memoryUsage: document.getElementById('memUsage').textContent,
                    cpuLoad: document.getElementById('cpuLoad').textContent
                },
                tests: Object.keys(testResults).map(test => ({
                    name: test,
                    result: testResults[test] ? 'pass' : 'fail'
                }))
            };
            
            const blob = new Blob([JSON.stringify(data, null, 2)], 
                { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `monitor-export-${Date.now()}.json`;
            a.click();
            
            log('[EXPORT] Data exported successfully', 'success');
        }
        
        function runDiagnostics() {
            log('[DIAGNOSTIC] Running system diagnostics...', 'warning');
            
            setTimeout(() => {
                log('[DIAGNOSTIC] Checking Digital Human core...', 'info');
                log('[DIAGNOSTIC] ✓ Core systems operational', 'success');
            }, 500);
            
            setTimeout(() => {
                log('[DIAGNOSTIC] Checking Memory systems...', 'info');
                log('[DIAGNOSTIC] ✓ All 9 memory types functional', 'success');
            }, 1000);
            
            setTimeout(() => {
                log('[DIAGNOSTIC] Checking Voice interfaces...', 'info');
                const hasAPIs = sessionStorage.getItem('openai_api_key') || 
                               sessionStorage.getItem('elevenlabs_api_key');
                if (hasAPIs) {
                    log('[DIAGNOSTIC] ✓ Voice APIs configured', 'success');
                } else {
                    log('[DIAGNOSTIC] ⚠ No voice APIs configured', 'warning');
                }
            }, 1500);
            
            setTimeout(() => {
                log('[DIAGNOSTIC] Checking BCI connection...', 'info');
                log('[DIAGNOSTIC] ✓ BCI simulation active', 'success');
            }, 2000);
            
            setTimeout(() => {
                log('[DIAGNOSTIC] System diagnostics complete', 'success');
                log(`[DIAGNOSTIC] Overall health: OPTIMAL`, 'success');
            }, 2500);
        }
        
        // Auto-start monitoring
        window.onload = () => {
            startMonitoring();
            log('[SYSTEM] Monitor interface loaded', 'success');
            log('[SYSTEM] Waiting for test data...', 'info');
        };
    </script>
</body>
</html>